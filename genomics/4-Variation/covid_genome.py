# -*- coding: utf-8 -*-

import logging
from urllib.parse import urljoin

import click
import bioblend.galaxy

from workflow2executable.invocations import InvocationMonitor

log = logging.Logger(__name__)
log.setLevel(logging.INFO)
# create a console handler with INFO loglevel
ch = logging.StreamHandler()
ch.setLevel(logging.INFO)
log.addHandler(ch)

FULL_WORKFLOW = {'a_galaxy_workflow': 'true', 'annotation': '', 'format-version': '0.1', 'name': 'Download and SE+PE Illumina Covid Variation Workflow', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'NC_45512 GenBank file'}], 'label': 'NC_45512 GenBank file', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 200, 'top': 200}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': 'd9873a4d-05d2-4fff-8fd5-ff7d9f6c6b5c', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '1ffc845a-8f5e-4c18-b1fc-ed64bb934ab8'}]}, '1': {'annotation': '', 'content_id': None, 'errors': None, 'id': 1, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Accessions file'}], 'label': 'Accessions file', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 200, 'top': 309.00390625}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': '3085bf19-e489-425f-b85d-9e66283d4913', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '9d967ba2-24ce-4cec-92bd-bccc7035068e'}]}, '2': {'annotation': '', 'id': 2, 'input_connections': {'Accessions': {'id': 1, 'input_subworkflow_step_id': 0, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'Parallel accession download Illumina', 'outputs': [], 'position': {'left': 485.99609375, 'top': 200}, 'subworkflow': {'a_galaxy_workflow': 'true', 'annotation': '', 'format-version': '0.1', 'name': 'Parallel accession download Illumina', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Accessions'}], 'label': 'Accessions', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 254.94140625, 'top': 433.3984375}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': '7c5bde2b-4386-4554-9fd7-b1249e3304a2', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '13660ab4-6f8e-48b9-9612-e78e8ea70ef3'}]}, '1': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.4.0', 'errors': None, 'id': 1, 'input_connections': {'split_parms|input': {'id': 0, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'Split file', 'outputs': [{'name': 'list_output_txt', 'type': 'input'}], 'position': {'left': 325.44921875, 'top': 566.40625}, 'post_job_actions': {'HideDatasetActionlist_output_txt': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'list_output_txt'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.4.0', 'tool_shed_repository': {'changeset_revision': 'e77b954f0da5', 'name': 'split_file_to_collection', 'owner': 'bgruening', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"split_parms": {"select_ftype": "txt", "__current_case__": 5, "input": {"__class__": "ConnectedValue"}, "select_mode": {"mode": "chunk", "__current_case__": 0, "chunksize": "1"}, "newfilenames": "split_file", "select_allocate": {"allocate": "byrow", "__current_case__": 2}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '9425973e-555e-49ad-b3e5-22ede32fa511', 'workflow_outputs': []}, '2': {'annotation': '', 'content_id': 'param_value_from_file', 'errors': None, 'id': 2, 'input_connections': {'input1': {'id': 1, 'output_name': 'list_output_txt'}}, 'inputs': [], 'label': None, 'name': 'Parse parameter value', 'outputs': [{'name': 'text_param', 'type': 'expression.json'}], 'position': {'left': 516.97265625, 'top': 393.3984375}, 'post_job_actions': {}, 'tool_id': 'param_value_from_file', 'tool_state': '{"input1": {"__class__": "ConnectedValue"}, "param_type": "text", "remove_newlines": "true", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'b2bb782a-7f96-4211-88fb-4d2cdb02e544', 'workflow_outputs': [{'label': None, 'output_name': 'text_param', 'uuid': 'c27b87fa-7353-48b9-9bde-7a7c19c7db9d'}]}, '3': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/2.10.4+galaxy2', 'errors': None, 'id': 3, 'input_connections': {'input|accession': {'id': 2, 'output_name': 'text_param'}}, 'inputs': [], 'label': None, 'name': 'Faster Download and Extract Reads in FASTQ', 'outputs': [{'name': 'list_paired', 'type': 'input'}, {'name': 'output_collection', 'type': 'input'}, {'name': 'output_collection_other', 'type': 'input'}, {'name': 'log', 'type': 'txt'}], 'position': {'left': 783.8671875, 'top': 494.375}, 'post_job_actions': {'HideDatasetActionlist_paired': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'list_paired'}, 'HideDatasetActionlog': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'log'}, 'HideDatasetActionoutput_collection': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output_collection'}, 'HideDatasetActionoutput_collection_other': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output_collection_other'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/2.10.4+galaxy2', 'tool_shed_repository': {'changeset_revision': 'c441583adae5', 'name': 'sra_tools', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"adv": {"minlen": "", "split": "--split-3", "skip_technical": "true"}, "input": {"input_select": "accession_number", "__current_case__": 0, "accession": {"__class__": "ConnectedValue"}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'f2889630-de0b-4365-8c4c-85b233367ab3', 'workflow_outputs': []}, '4': {'annotation': '', 'content_id': '__APPLY_RULES__', 'errors': None, 'id': 4, 'input_connections': {'input': {'id': 3, 'output_name': 'list_paired'}}, 'inputs': [], 'label': None, 'name': 'Apply Rule to Collection', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1120.91796875, 'top': 519.375}, 'post_job_actions': {'TagDatasetActionoutput': {'action_arguments': {'tags': 'name:PE'}, 'action_type': 'TagDatasetAction', 'output_name': 'output'}}, 'tool_id': '__APPLY_RULES__', 'tool_state': '{"input": {"__class__": "ConnectedValue"}, "rules": {"mapping": [{"collapsible_value": {"__class__": "RuntimeValue"}, "columns": [1], "connectable": true, "editing": false, "is_workflow": false, "type": "list_identifiers"}, {"collapsible_value": {"__class__": "RuntimeValue"}, "columns": [2], "connectable": true, "is_workflow": false, "type": "paired_identifier"}], "rules": [{"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier0", "warn": null}, {"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier1", "warn": null}, {"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier2", "warn": null}]}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '7f4ea4eb-e947-4279-b51a-9d91f4b3afbc', 'workflow_outputs': [{'label': 'Paired End Illumina Reads', 'output_name': 'output', 'uuid': 'a4541223-af75-4f6b-b64e-6f1e79b0569c'}]}, '5': {'annotation': '', 'content_id': '__APPLY_RULES__', 'errors': None, 'id': 5, 'input_connections': {'input': {'id': 3, 'output_name': 'output_collection'}}, 'inputs': [], 'label': None, 'name': 'Apply Rule to Collection', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1117.96875, 'top': 655.4296875}, 'post_job_actions': {'TagDatasetActionoutput': {'action_arguments': {'tags': 'name:SE'}, 'action_type': 'TagDatasetAction', 'output_name': 'output'}}, 'tool_id': '__APPLY_RULES__', 'tool_state': '{"input": {"__class__": "ConnectedValue"}, "rules": {"mapping": [{"collapsible_value": {"__class__": "RuntimeValue"}, "columns": [1], "connectable": true, "editing": false, "is_workflow": false, "type": "list_identifiers"}], "rules": [{"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier0", "warn": null}, {"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier1", "warn": null}]}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '40910e7c-b05f-42c1-993e-e8a9b7ba20e0', 'workflow_outputs': [{'label': 'Single End Illumina Reads', 'output_name': 'output', 'uuid': 'b1c5bc41-4a87-4032-b3dd-0e77af5bc7df'}]}}, 'tags': '', 'uuid': 'd5f4e66a-3e95-4099-8a7a-d58333400dc9'}, 'tool_id': 'd9fb7af95ad2f6e3', 'type': 'subworkflow', 'uuid': 'f5faa0dd-75e8-4b82-8c09-9785695c4c4a', 'workflow_outputs': [{'label': None, 'output_name': 'Single End Illumina Reads', 'uuid': 'f0585421-8ea7-4720-bbb2-37160a19da2c'}, {'label': None, 'output_name': 'Paired End Illumina Reads', 'uuid': '5d40af28-2e87-4f6b-b4ac-2aadd4fdce4c'}, {'label': None, 'output_name': '2:text_param', 'uuid': '806bac7e-51c1-42f8-bbcc-df69b4e117f9'}]}, '3': {'annotation': '', 'id': 3, 'input_connections': {'GenBank file ': {'id': 0, 'input_subworkflow_step_id': 0, 'output_name': 'output'}, 'Paired Collection (fastqsanger)': {'id': 2, 'input_subworkflow_step_id': 1, 'output_name': 'Paired End Illumina Reads'}}, 'inputs': [], 'label': None, 'name': 'COVID-19: PE Variation', 'outputs': [], 'position': {'left': 772.01171875, 'top': 200}, 'subworkflow': {'a_galaxy_workflow': 'true', 'annotation': '', 'format-version': '0.1', 'name': 'COVID-19: PE Variation', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'GenBank file '}], 'label': 'GenBank file ', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 200, 'top': 348.96484375}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': 'a2551475-5db6-4bcc-a4b8-3a7d888633a6', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': 'fb25da87-d64c-4f4d-8394-ee49afbb9295'}]}, '1': {'annotation': '', 'content_id': None, 'errors': None, 'id': 1, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Paired Collection (fastqsanger)'}], 'label': 'Paired Collection (fastqsanger)', 'name': 'Input dataset collection', 'outputs': [], 'position': {'left': 200, 'top': 437.96875}, 'tool_id': None, 'tool_state': '{"optional": false, "collection_type": "list:paired"}', 'tool_version': None, 'type': 'data_collection_input', 'uuid': 'a72f4e4c-9a9a-4d36-9173-43b7c33a229f', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': 'a1738b9a-4e5c-43b0-949b-4a1f8ff6b607'}]}, '2': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'errors': None, 'id': 2, 'input_connections': {'input_type|input_gbk': {'id': 0, 'output_name': 'output'}}, 'inputs': [{'description': 'runtime parameter for tool SnpEff build:', 'name': 'input_type'}], 'label': None, 'name': 'SnpEff build:', 'outputs': [{'name': 'snpeff_output', 'type': 'snpeffdb'}, {'name': 'output_fasta', 'type': 'fasta'}], 'position': {'left': 485.99609375, 'top': 348.96484375}, 'post_job_actions': {'RenameDatasetActionsnpeff_output': {'action_arguments': {'newname': 'SpnEFF4.3 database for nCov'}, 'action_type': 'RenameDatasetAction', 'output_name': 'snpeff_output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'tool_shed_repository': {'changeset_revision': '268d162b9c49', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"codon_table": "Standard", "genome_version": "ncov", "input_type": {"input_type_selector": "gb", "__current_case__": 0, "input_gbk": {"__class__": "RuntimeValue"}, "fasta": "yes", "remove_version": "true"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'db95c5a5-5d5b-4be3-b93e-8f7871024f2c', 'workflow_outputs': [{'label': 'SpnEFF4.3 database for ncov', 'output_name': 'snpeff_output', 'uuid': 'b14bd638-e16b-4dbc-817c-a64485b6ef1c'}, {'label': 'Fasta sequence for nCov', 'output_name': 'output_fasta', 'uuid': 'b8d89b82-24e0-4706-876c-6165f7f25429'}]}, '3': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'errors': None, 'id': 3, 'input_connections': {'single_paired|paired_input': {'id': 1, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'fastp', 'outputs': [{'name': 'output_paired_coll', 'type': 'input'}, {'name': 'report_html', 'type': 'html'}, {'name': 'report_json', 'type': 'json'}], 'position': {'left': 485.99609375, 'top': 557.96875}, 'post_job_actions': {'HideDatasetActionoutput_paired_coll': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output_paired_coll'}, 'HideDatasetActionreport_html': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_html'}, 'HideDatasetActionreport_json': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_json'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'tool_shed_repository': {'changeset_revision': 'dbf9c561ef29', 'name': 'fastp', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"filter_options": {"quality_filtering_options": {"disable_quality_filtering": "false", "qualified_quality_phred": "", "unqualified_percent_limit": "", "n_base_limit": ""}, "length_filtering_options": {"disable_length_filtering": "false", "length_required": "", "length_limit": ""}, "low_complexity_filter": {"enable_low_complexity_filter": "false", "complexity_threshold": ""}}, "output_options": {"report_html": "true", "report_json": "true"}, "overrepresented_sequence_analysis": {"overrepresentation_analysis": "false", "overrepresentation_sampling": ""}, "read_mod_options": {"polyg_tail_trimming": {"trimming_select": "", "__current_case__": 1, "poly_g_min_len": ""}, "polyx_tail_trimming": {"polyx_trimming_select": "", "__current_case__": 1}, "umi_processing": {"umi": "false", "umi_loc": "", "umi_len": "", "umi_prefix": ""}, "cutting_by_quality_options": {"cut_by_quality5": "false", "cut_by_quality3": "false", "cut_window_size": "", "cut_mean_quality": ""}, "base_correction_options": {"correction": "false"}}, "single_paired": {"single_paired_selector": "paired_collection", "__current_case__": 2, "paired_input": {"__class__": "ConnectedValue"}, "adapter_trimming_options": {"disable_adapter_trimming": "false", "adapter_sequence1": "", "adapter_sequence2": ""}, "global_trimming_options": {"trim_front1": "", "trim_tail1": "", "trim_front2": "", "trim_tail2": ""}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '0bc39f45-c564-4b9e-9e6d-10f3d1f4bfd1', 'workflow_outputs': []}, '4': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.1', 'errors': None, 'id': 4, 'input_connections': {'fastq_input|fastq_input1': {'id': 3, 'output_name': 'output_paired_coll'}, 'reference_source|ref_file': {'id': 2, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Map with BWA-MEM', 'outputs': [{'name': 'bam_output', 'type': 'bam'}], 'position': {'left': 772.01171875, 'top': 348.96484375}, 'post_job_actions': {'HideDatasetActionbam_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'bam_output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.1', 'tool_shed_repository': {'changeset_revision': '01ac0a5fedc3', 'name': 'bwa', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__job_resource": {"__job_resource__select": "no", "__current_case__": 0}, "analysis_type": {"analysis_type_selector": "illumina", "__current_case__": 0}, "fastq_input": {"fastq_input_selector": "paired_collection", "__current_case__": 2, "fastq_input1": {"__class__": "ConnectedValue"}, "iset_stats": ""}, "reference_source": {"reference_source_selector": "history", "__current_case__": 1, "ref_file": {"__class__": "ConnectedValue"}, "index_a": "auto"}, "rg": {"rg_selector": "do_not_set", "__current_case__": 3}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'fcbe450e-9603-4871-8911-dd5c7297ea85', 'workflow_outputs': []}, '5': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtool_filter2/samtool_filter2/1.8+galaxy1', 'errors': None, 'id': 5, 'input_connections': {'input1': {'id': 4, 'output_name': 'bam_output'}}, 'inputs': [{'description': 'runtime parameter for tool Filter SAM or BAM, output SAM or BAM', 'name': 'bed_file'}], 'label': None, 'name': 'Filter SAM or BAM, output SAM or BAM', 'outputs': [{'name': 'output1', 'type': 'sam'}], 'position': {'left': 1059.0234375, 'top': 348.96484375}, 'post_job_actions': {'HideDatasetActionoutput1': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output1'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtool_filter2/samtool_filter2/1.8+galaxy1', 'tool_shed_repository': {'changeset_revision': '649a225999a5', 'name': 'samtool_filter2', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"bed_file": {"__class__": "RuntimeValue"}, "flag": {"filter": "yes", "__current_case__": 1, "reqBits": ["0x0001", "0x0002"], "skipBits": null}, "header": "-h", "input1": {"__class__": "ConnectedValue"}, "library": "", "mapq": "20", "outputtype": "bam", "possibly_select_inverse": "false", "read_group": "", "regions": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'b9c0ddde-e4b4-4bf8-853f-0fd942f0f403', 'workflow_outputs': []}, '6': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/2.0.2+galaxy2', 'errors': None, 'id': 6, 'input_connections': {'input': {'id': 5, 'output_name': 'output1'}}, 'inputs': [], 'label': None, 'name': 'Samtools stats', 'outputs': [{'name': 'output', 'type': 'tabular'}], 'position': {'left': 1345.01953125, 'top': 348.96484375}, 'post_job_actions': {'HideDatasetActionoutput': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/2.0.2+galaxy2', 'tool_shed_repository': {'changeset_revision': '145f6d74ff5e', 'name': 'samtools_stats', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"addref_cond": {"addref_select": "no", "__current_case__": 0}, "cond_region": {"select_region": "no", "__current_case__": 0}, "cov_threshold": "", "coverage_cond": {"coverage_select": "no", "__current_case__": 0}, "filter_by_flags": {"filter_flags": "nofilter", "__current_case__": 1}, "gc_depth": "", "input": {"__class__": "ConnectedValue"}, "insert_size": "", "most_inserts": "", "read_length": "", "remove_dups": "false", "remove_overlaps": "false", "sparse": "false", "split_output_cond": {"split_output_selector": "no", "__current_case__": 0}, "trim_quality": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '819a4d04-e1c8-4268-b6fc-ce51465d837c', 'workflow_outputs': []}, '7': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'errors': None, 'id': 7, 'input_connections': {'inputFile': {'id': 5, 'output_name': 'output1'}}, 'inputs': [], 'label': None, 'name': 'MarkDuplicates', 'outputs': [{'name': 'metrics_file', 'type': 'txt'}, {'name': 'outFile', 'type': 'bam'}], 'position': {'left': 1345.01953125, 'top': 487.96875}, 'post_job_actions': {'HideDatasetActionmetrics_file': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'metrics_file'}, 'HideDatasetActionoutFile': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'outFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'tool_shed_repository': {'changeset_revision': '7d34178f2812', 'name': 'picard', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"assume_sorted": "true", "barcode_tag": "", "comments": [], "duplicate_scoring_strategy": "SUM_OF_BASE_QUALITIES", "inputFile": {"__class__": "ConnectedValue"}, "optical_duplicate_pixel_distance": "100", "read_name_regex": "", "remove_duplicates": "true", "validation_stringency": "LENIENT", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'f51270ca-497b-4637-90fa-fe70e0f65210', 'workflow_outputs': []}, '8': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'errors': None, 'id': 8, 'input_connections': {'reads': {'id': 7, 'output_name': 'outFile'}, 'reference_source|ref': {'id': 2, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Realign reads', 'outputs': [{'name': 'realigned', 'type': 'bam'}], 'position': {'left': 1631.03515625, 'top': 348.96484375}, 'post_job_actions': {'RenameDatasetActionrealigned': {'action_arguments': {'newname': 'Realigned Aligments'}, 'action_type': 'RenameDatasetAction', 'output_name': 'realigned'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'tool_shed_repository': {'changeset_revision': 'cdaab621d454', 'name': 'lofreq_viterbi', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"adv_options": {"delflags": "true", "bq2_handling": {"replace_bq2": "keep", "__current_case__": 0, "defqual": "2"}}, "reads": {"__class__": "ConnectedValue"}, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "ConnectedValue"}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'aa0ca032-373b-413b-9509-a7314b8ed9ee', 'workflow_outputs': [{'label': 'Realigned Aligments', 'output_name': 'realigned', 'uuid': 'd2fc828b-35e0-4b7e-ac1e-357707113dd7'}]}, '9': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'errors': None, 'id': 9, 'input_connections': {'results_0|software_cond|input': {'id': 3, 'output_name': 'report_json'}, 'results_1|software_cond|output_0|type|input': {'id': 6, 'output_name': 'output'}, 'results_2|software_cond|output_0|input': {'id': 7, 'output_name': 'metrics_file'}}, 'inputs': [], 'label': None, 'name': 'MultiQC', 'outputs': [{'name': 'stats', 'type': 'input'}, {'name': 'plots', 'type': 'input'}, {'name': 'html_report', 'type': 'html'}], 'position': {'left': 1631.03515625, 'top': 537.96875}, 'post_job_actions': {'HideDatasetActionplots': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'plots'}, 'HideDatasetActionstats': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'stats'}, 'RenameDatasetActionhtml_report': {'action_arguments': {'newname': 'MultiQC Report PE'}, 'action_type': 'RenameDatasetAction', 'output_name': 'html_report'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'tool_shed_repository': {'changeset_revision': '3d93dd18d9f8', 'name': 'multiqc', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"comment": "", "flat": "false", "results": [{"__index__": 0, "software_cond": {"software": "fastp", "__current_case__": 7, "input": {"__class__": "ConnectedValue"}}}, {"__index__": 1, "software_cond": {"software": "samtools", "__current_case__": 22, "output": [{"__index__": 0, "type": {"type": "stats", "__current_case__": 0, "input": {"__class__": "ConnectedValue"}}}]}}, {"__index__": 2, "software_cond": {"software": "picard", "__current_case__": 17, "output": [{"__index__": 0, "type": "markdups", "input": {"__class__": "ConnectedValue"}}]}}], "saveLog": "false", "title": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '7b21cfde-2462-4228-a156-98cfa634ebe9', 'workflow_outputs': [{'label': 'MultiQC Report PE', 'output_name': 'html_report', 'uuid': '41537eed-e15d-4abf-8c6a-d28dd237f617'}]}, '10': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy0', 'errors': None, 'id': 10, 'input_connections': {'reads': {'id': 8, 'output_name': 'realigned'}, 'reference_source|ref': {'id': 2, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Call variants', 'outputs': [{'name': 'variants', 'type': 'vcf'}], 'position': {'left': 1917.03125, 'top': 348.96484375}, 'post_job_actions': {'HideDatasetActionvariants': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'variants'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy0', 'tool_shed_repository': {'changeset_revision': '03627f24605f', 'name': 'lofreq_call', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__job_resource": {"__job_resource__select": "no", "__current_case__": 0}, "call_control": {"set_call_options": "yes", "__current_case__": 1, "coverage": {"min_cov": "50", "max_depth": "1000000"}, "pe": {"use_orphan": "false"}, "bc_quals": {"min_bq": "30", "min_alt_bq": "30", "def_alt_bq": "0"}, "align_quals": {"alnqual": {"use_alnqual": "", "__current_case__": 0, "alnqual_choice": {"alnquals_to_use": "", "__current_case__": 1, "extended_baq": "true"}}}, "map_quals": {"min_mq": "20", "use_mq": {"no_mq": "", "__current_case__": 0, "max_mq": "255"}}, "source_qual": {"use_src_qual": {"src_qual": "", "__current_case__": 0}}, "joint_qual": {"min_jq": "0", "min_alt_jq": "0", "def_alt_jq": "0"}}, "filter_control": {"filter_type": "set_lofreq_standard", "__current_case__": 2, "sig": "0.01", "bonf": "dynamic", "others": ""}, "reads": {"__class__": "ConnectedValue"}, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "ConnectedValue"}}, "regions": {"restrict_to_region": "genome", "__current_case__": 0}, "variant_types": "--call-indels", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '27dde131-3bf8-4ab1-99f8-675bd75ef224', 'workflow_outputs': []}, '11': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'errors': None, 'id': 11, 'input_connections': {'input': {'id': 10, 'output_name': 'variants'}, 'snpDb|snpeff_db': {'id': 2, 'output_name': 'snpeff_output'}}, 'inputs': [{'description': 'runtime parameter for tool SnpEff eff:', 'name': 'intervals'}, {'description': 'runtime parameter for tool SnpEff eff:', 'name': 'transcripts'}], 'label': None, 'name': 'SnpEff eff:', 'outputs': [{'name': 'snpeff_output', 'type': 'vcf'}, {'name': 'statsFile', 'type': 'html'}], 'position': {'left': 2204.04296875, 'top': 348.96484375}, 'post_job_actions': {'HideDatasetActionsnpeff_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'snpeff_output'}, 'RenameDatasetActionstatsFile': {'action_arguments': {'newname': 'SnpEFF HTML stats'}, 'action_type': 'RenameDatasetAction', 'output_name': 'statsFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'tool_shed_repository': {'changeset_revision': '5a29ab10dba6', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"annotations": ["-formatEff", "-classic"], "chr": "", "csvStats": "false", "filter": {"specificEffects": "no", "__current_case__": 0}, "filterOut": ["-no-downstream", "-no-intergenic", "-no-intron", "-no-upstream", "-no-utr"], "generate_stats": "true", "input": {"__class__": "ConnectedValue"}, "inputFormat": "vcf", "intervals": {"__class__": "RuntimeValue"}, "noLog": "true", "offset": "default", "outputConditional": {"outputFormat": "vcf", "__current_case__": 0}, "snpDb": {"genomeSrc": "custom", "__current_case__": 3, "snpeff_db": {"__class__": "ConnectedValue"}, "codon_table": "Standard"}, "spliceRegion": {"setSpliceRegions": "no", "__current_case__": 0}, "spliceSiteSize": null, "transcripts": {"__class__": "RuntimeValue"}, "udLength": "0", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '270ca9ac-f9c1-45d5-8de2-3964a83bd34a', 'workflow_outputs': [{'label': 'SnpEFF HTML stats', 'output_name': 'statsFile', 'uuid': 'b6729a11-7230-40f4-9623-db8b49f5e074'}]}, '12': {'annotation': '', 'content_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'errors': None, 'id': 12, 'input_connections': {'input1': {'id': 11, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'Convert VCF to VCF_BGZIP', 'outputs': [{'name': 'output1', 'type': 'vcf_bgzip'}], 'position': {'left': 2490.05859375, 'top': 348.96484375}, 'post_job_actions': {'RenameDatasetActionoutput1': {'action_arguments': {'newname': 'SnpEff vcf.gz'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output1'}}, 'tool_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'tool_state': '{"input1": {"__class__": "ConnectedValue"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '3b5358cf-a693-49b4-99d7-dc34e874835d', 'workflow_outputs': [{'label': 'SnpEff vcf.gz', 'output_name': 'output1', 'uuid': '09fcc2aa-4337-4891-bdb0-baf7cd7009c8'}]}, '13': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'errors': None, 'id': 13, 'input_connections': {'input': {'id': 11, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'SnpSift Extract Fields', 'outputs': [{'name': 'output', 'type': 'tabular'}], 'position': {'left': 2490.05859375, 'top': 487.96875}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'SnpSift tabular output'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'tool_shed_repository': {'changeset_revision': '09d6806c609e', 'name': 'snpsift', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"empty_text": ".", "extract": "CHROM POS REF ALT DP AF SB DP4 EFF[*].IMPACT EFF[*].FUNCLASS EFF[*].EFFECT EFF[*].GENE EFF[*].CODON", "input": {"__class__": "ConnectedValue"}, "one_effect_per_line": "true", "separator": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '77f313a8-932b-42f1-a50b-8fe3a04843e1', 'workflow_outputs': [{'label': 'SnpSift tabular output', 'output_name': 'output', 'uuid': 'a1e82f59-acee-4535-97d6-2339cab6f04c'}]}}, 'tags': '', 'uuid': '56795bce-236b-4f6b-ac2d-748165126439'}, 'tool_id': 'ffb1ba2fb99e9912', 'type': 'subworkflow', 'uuid': 'b5ca36d9-f849-4fff-9405-d423a527c49d', 'workflow_outputs': [{'label': None, 'output_name': 'Fasta sequence for nCov', 'uuid': '2e25af00-6809-4857-9e80-5e45f70a83b2'}, {'label': None, 'output_name': 'SpnEFF4.3 database for ncov', 'uuid': 'fbaf7d92-7073-48b2-9dee-b1e144901ada'}, {'label': None, 'output_name': 'Realigned Aligments', 'uuid': '74e9b1ce-91c6-46b8-a3da-ae3e2f1003b7'}, {'label': None, 'output_name': 'MultiQC Report PE', 'uuid': '6d5a32f4-9227-4ff1-91e1-2f4e8f0c564b'}, {'label': None, 'output_name': 'SnpEFF HTML stats', 'uuid': '4ae02197-b758-4ec1-9aa0-faa2f94c35c4'}, {'label': None, 'output_name': 'SnpEff vcf.gz', 'uuid': 'b043d5ca-52bf-4704-ab20-24391f7c6939'}, {'label': None, 'output_name': 'SnpSift tabular output', 'uuid': '86bbbace-db8a-42bd-ba2f-02964558b2de'}]}, '4': {'annotation': '', 'id': 4, 'input_connections': {'Genbank file': {'id': 0, 'input_subworkflow_step_id': 1, 'output_name': 'output'}, 'Single End Collection (fastqsanger)': {'id': 2, 'input_subworkflow_step_id': 0, 'output_name': 'Single End Illumina Reads'}}, 'inputs': [], 'label': None, 'name': 'COVID-19: SE Variation', 'outputs': [], 'position': {'left': 772.01171875, 'top': 629.00390625}, 'subworkflow': {'a_galaxy_workflow': 'true', 'annotation': '', 'format-version': '0.1', 'name': 'COVID-19: SE Variation', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Single End Collection (fastqsanger)'}], 'label': 'Single End Collection (fastqsanger)', 'name': 'Input dataset collection', 'outputs': [], 'position': {'left': 201.9921875, 'top': 326.9140625}, 'tool_id': None, 'tool_state': '{"optional": false, "collection_type": "list"}', 'tool_version': None, 'type': 'data_collection_input', 'uuid': '3a5c409f-7e02-4ade-8d86-746798938c42', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': 'e6990007-c98d-49bb-a918-b3fb6a412670'}]}, '1': {'annotation': '', 'content_id': None, 'errors': None, 'id': 1, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Genbank file'}], 'label': 'Genbank file', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 200, 'top': 434.921875}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': 'b4c96d5c-e6c1-40b4-a35d-d66f3ffa22a6', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '9d8e081b-25fe-4550-89db-97019b96f27f'}]}, '2': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'errors': None, 'id': 2, 'input_connections': {'single_paired|in1': {'id': 0, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'fastp', 'outputs': [{'name': 'out1', 'type': 'input'}, {'name': 'report_html', 'type': 'html'}, {'name': 'report_json', 'type': 'json'}], 'position': {'left': 485.99609375, 'top': 325.91796875}, 'post_job_actions': {'HideDatasetActionout1': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'out1'}, 'HideDatasetActionreport_html': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_html'}, 'HideDatasetActionreport_json': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_json'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'tool_shed_repository': {'changeset_revision': 'dbf9c561ef29', 'name': 'fastp', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"filter_options": {"quality_filtering_options": {"disable_quality_filtering": "false", "qualified_quality_phred": "", "unqualified_percent_limit": "", "n_base_limit": ""}, "length_filtering_options": {"disable_length_filtering": "false", "length_required": "", "length_limit": ""}, "low_complexity_filter": {"enable_low_complexity_filter": "false", "complexity_threshold": ""}}, "output_options": {"report_html": "true", "report_json": "true"}, "overrepresented_sequence_analysis": {"overrepresentation_analysis": "false", "overrepresentation_sampling": ""}, "read_mod_options": {"polyg_tail_trimming": {"trimming_select": "", "__current_case__": 1, "poly_g_min_len": ""}, "polyx_tail_trimming": {"polyx_trimming_select": "", "__current_case__": 1}, "umi_processing": {"umi": "false", "umi_loc": "", "umi_len": "", "umi_prefix": ""}, "cutting_by_quality_options": {"cut_by_quality5": "false", "cut_by_quality3": "false", "cut_window_size": "", "cut_mean_quality": ""}, "base_correction_options": {"correction": "false"}}, "single_paired": {"single_paired_selector": "single", "__current_case__": 0, "in1": {"__class__": "ConnectedValue"}, "adapter_trimming_options": {"disable_adapter_trimming": "false", "adapter_sequence1": ""}, "global_trimming_options": {"trim_front1": "", "trim_tail1": ""}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'f102fdbf-78bc-4a38-ad6b-2202714e3438', 'workflow_outputs': []}, '3': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'errors': None, 'id': 3, 'input_connections': {'input_type|input_gbk': {'id': 1, 'output_name': 'output'}}, 'inputs': [{'description': 'runtime parameter for tool SnpEff build:', 'name': 'input_type'}], 'label': None, 'name': 'SnpEff build:', 'outputs': [{'name': 'snpeff_output', 'type': 'snpeffdb'}, {'name': 'output_fasta', 'type': 'fasta'}], 'position': {'left': 485.99609375, 'top': 564.921875}, 'post_job_actions': {'HideDatasetActionoutput_fasta': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output_fasta'}, 'HideDatasetActionsnpeff_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'snpeff_output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'tool_shed_repository': {'changeset_revision': '268d162b9c49', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"codon_table": "Standard", "genome_version": "covid-19", "input_type": {"input_type_selector": "gb", "__current_case__": 0, "input_gbk": {"__class__": "RuntimeValue"}, "fasta": "yes", "remove_version": "true"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '875809d5-aaff-4bf2-827f-b153dd3a3b0e', 'workflow_outputs': []}, '4': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.3.4.3+galaxy0', 'errors': None, 'id': 4, 'input_connections': {'library|input_1': {'id': 2, 'output_name': 'out1'}, 'reference_genome|own_file': {'id': 3, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Bowtie2', 'outputs': [{'name': 'output', 'type': 'bam'}, {'name': 'mapping_stats', 'type': 'txt'}], 'position': {'left': 772.01171875, 'top': 325.91796875}, 'post_job_actions': {'HideDatasetActionmapping_stats': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'mapping_stats'}, 'HideDatasetActionoutput': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.3.4.3+galaxy0', 'tool_shed_repository': {'changeset_revision': '749c918495f7', 'name': 'bowtie2', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__input_ext": "input", "__job_resource": {"__job_resource__select": "no", "__current_case__": 0}, "analysis_type": {"analysis_type_selector": "simple", "__current_case__": 0, "presets": "--very-sensitive"}, "chromInfo": "/cvmfs/data.galaxyproject.org/managed/len/ucsc/?.len", "input_1|__identifier__": "SRR11247078", "library": {"type": "single", "__current_case__": 0, "input_1": {"__class__": "ConnectedValue"}, "unaligned_file": "false", "aligned_file": "false"}, "reference_genome": {"source": "history", "__current_case__": 1, "own_file": {"__class__": "ConnectedValue"}}, "rg": {"rg_selector": "do_not_set", "__current_case__": 3}, "sam_options": {"sam_options_selector": "no", "__current_case__": 1}, "save_mapping_stats": "true", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '1ddb8b93-f6c1-4053-8900-54562344249d', 'workflow_outputs': []}, '5': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'errors': None, 'id': 5, 'input_connections': {'inputFile': {'id': 4, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'MarkDuplicates', 'outputs': [{'name': 'metrics_file', 'type': 'txt'}, {'name': 'outFile', 'type': 'bam'}], 'position': {'left': 1059.0234375, 'top': 325.91796875}, 'post_job_actions': {'HideDatasetActionmetrics_file': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'metrics_file'}, 'HideDatasetActionoutFile': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'outFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'tool_shed_repository': {'changeset_revision': '7d34178f2812', 'name': 'picard', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__input_ext": "bam", "assume_sorted": "true", "barcode_tag": "", "chromInfo": "/cvmfs/data.galaxyproject.org/managed/len/ucsc/?.len", "comments": [], "duplicate_scoring_strategy": "SUM_OF_BASE_QUALITIES", "inputFile": {"__class__": "ConnectedValue"}, "inputFile|__identifier__": "SRR11247078", "optical_duplicate_pixel_distance": "100", "read_name_regex": "", "remove_duplicates": "true", "validation_stringency": "LENIENT", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'c5a6f563-8824-4b1c-a70f-274040c1c907', 'workflow_outputs': []}, '6': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'errors': None, 'id': 6, 'input_connections': {'reads': {'id': 5, 'output_name': 'outFile'}, 'reference_source|ref': {'id': 3, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Realign reads', 'outputs': [{'name': 'realigned', 'type': 'bam'}], 'position': {'left': 1345.01953125, 'top': 325.91796875}, 'post_job_actions': {'RenameDatasetActionrealigned': {'action_arguments': {'newname': 'Realigned Alignments'}, 'action_type': 'RenameDatasetAction', 'output_name': 'realigned'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'tool_shed_repository': {'changeset_revision': 'cdaab621d454', 'name': 'lofreq_viterbi', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__job_resource": {"__job_resource__select": "no", "__current_case__": 0}, "adv_options": {"delflags": "true", "bq2_handling": {"replace_bq2": "keep", "__current_case__": 0, "defqual": "2"}}, "reads": {"__class__": "ConnectedValue"}, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "ConnectedValue"}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'f96caa61-6b52-4623-a89b-a53a5e046a44', 'workflow_outputs': [{'label': 'Realigned Alignments', 'output_name': 'realigned', 'uuid': 'c9867318-36de-47cc-af39-2be293d1e705'}]}, '7': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'errors': None, 'id': 7, 'input_connections': {'results_0|software_cond|input': {'id': 2, 'output_name': 'report_json'}, 'results_1|software_cond|input': {'id': 4, 'output_name': 'mapping_stats'}, 'results_2|software_cond|output_0|input': {'id': 5, 'output_name': 'metrics_file'}}, 'inputs': [], 'label': None, 'name': 'MultiQC', 'outputs': [{'name': 'stats', 'type': 'input'}, {'name': 'plots', 'type': 'input'}, {'name': 'html_report', 'type': 'html'}], 'position': {'left': 1345.01953125, 'top': 514.921875}, 'post_job_actions': {'HideDatasetActionplots': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'plots'}, 'HideDatasetActionstats': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'stats'}, 'RenameDatasetActionhtml_report': {'action_arguments': {'newname': 'MultiQC Report SE'}, 'action_type': 'RenameDatasetAction', 'output_name': 'html_report'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'tool_shed_repository': {'changeset_revision': '3d93dd18d9f8', 'name': 'multiqc', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"comment": "", "flat": "false", "results": [{"__index__": 0, "software_cond": {"software": "fastp", "__current_case__": 7, "input": {"__class__": "ConnectedValue"}}}, {"__index__": 1, "software_cond": {"software": "bowtie2", "__current_case__": 3, "input": {"__class__": "ConnectedValue"}}}, {"__index__": 2, "software_cond": {"software": "picard", "__current_case__": 17, "output": [{"__index__": 0, "type": "markdups", "input": {"__class__": "ConnectedValue"}}]}}], "saveLog": "false", "title": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'a4d6d5d5-f550-41a2-b51d-0515393225f2', 'workflow_outputs': [{'label': 'MultiQC Report SE', 'output_name': 'html_report', 'uuid': '33e70105-fa3c-4c2b-8484-3fcb8bc1d646'}]}, '8': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy1', 'errors': None, 'id': 8, 'input_connections': {'reads': {'id': 6, 'output_name': 'realigned'}, 'reference_source|ref': {'id': 3, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Call variants', 'outputs': [{'name': 'variants', 'type': 'vcf'}], 'position': {'left': 1631.03515625, 'top': 325.91796875}, 'post_job_actions': {'HideDatasetActionvariants': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'variants'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy1', 'tool_shed_repository': {'changeset_revision': 'dfadc322b065', 'name': 'lofreq_call', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__input_ext": "bam", "__job_resource": {"__job_resource__select": "no", "__current_case__": 0}, "call_control": {"set_call_options": "yes", "__current_case__": 1, "coverage": {"min_cov": "100", "max_depth": "1000000"}, "pe": {"use_orphan": "false"}, "bc_quals": {"min_bq": "30", "min_alt_bq": "30", "alt_bq": {"modify": "", "__current_case__": 0}}, "align_quals": {"alnqual": {"use_alnqual": "", "__current_case__": 0, "alnqual_choice": {"alnquals_to_use": "", "__current_case__": 1, "extended_baq": "true"}}}, "map_quals": {"min_mq": "20", "use_mq": {"no_mq": "", "__current_case__": 0, "max_mq": "255"}}, "source_qual": {"use_src_qual": {"src_qual": "", "__current_case__": 0}}, "joint_qual": {"min_jq": "0", "min_alt_jq": "0", "def_alt_jq": "0"}}, "chromInfo": "/cvmfs/data.galaxyproject.org/managed/len/ucsc/?.len", "filter_control": {"filter_type": "set_lofreq_standard", "__current_case__": 2, "sig": "0.01", "bonf": "dynamic", "others": ""}, "reads": {"__class__": "ConnectedValue"}, "reads|__identifier__": "SRR11247078", "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "ConnectedValue"}}, "regions": {"restrict_to_region": "genome", "__current_case__": 0}, "variant_types": "--call-indels", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '5259a9a7-cce3-4fcc-badc-630bad6fee82', 'workflow_outputs': []}, '9': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'errors': None, 'id': 9, 'input_connections': {'input': {'id': 8, 'output_name': 'variants'}, 'snpDb|snpeff_db': {'id': 3, 'output_name': 'snpeff_output'}}, 'inputs': [{'description': 'runtime parameter for tool SnpEff eff:', 'name': 'intervals'}, {'description': 'runtime parameter for tool SnpEff eff:', 'name': 'transcripts'}], 'label': None, 'name': 'SnpEff eff:', 'outputs': [{'name': 'snpeff_output', 'type': 'vcf'}, {'name': 'statsFile', 'type': 'html'}], 'position': {'left': 1917.03125, 'top': 325.91796875}, 'post_job_actions': {'HideDatasetActionsnpeff_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'snpeff_output'}, 'RenameDatasetActionstatsFile': {'action_arguments': {'newname': 'SnpEFF HTML stats'}, 'action_type': 'RenameDatasetAction', 'output_name': 'statsFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'tool_shed_repository': {'changeset_revision': '5a29ab10dba6', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"annotations": ["-formatEff", "-classic"], "chr": "", "csvStats": "false", "filter": {"specificEffects": "no", "__current_case__": 0}, "filterOut": ["-no-downstream", "-no-intergenic", "-no-intron", "-no-upstream", "-no-utr"], "generate_stats": "true", "input": {"__class__": "ConnectedValue"}, "inputFormat": "vcf", "intervals": {"__class__": "RuntimeValue"}, "noLog": "true", "offset": "default", "outputConditional": {"outputFormat": "vcf", "__current_case__": 0}, "snpDb": {"genomeSrc": "custom", "__current_case__": 3, "snpeff_db": {"__class__": "ConnectedValue"}, "codon_table": "Standard"}, "spliceRegion": {"setSpliceRegions": "no", "__current_case__": 0}, "spliceSiteSize": null, "transcripts": {"__class__": "RuntimeValue"}, "udLength": "0", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '28aaa6f9-0f84-4b17-8203-528a5a15bd44', 'workflow_outputs': [{'label': 'SnpEFF HTML stats', 'output_name': 'statsFile', 'uuid': '30f40c67-fc9b-4377-ac8f-2e0a94b3f246'}]}, '10': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'errors': None, 'id': 10, 'input_connections': {'input': {'id': 9, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'SnpSift Extract Fields', 'outputs': [{'name': 'output', 'type': 'tabular'}], 'position': {'left': 2204.04296875, 'top': 325.91796875}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'SnpSift tabular output'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'tool_shed_repository': {'changeset_revision': '09d6806c609e', 'name': 'snpsift', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"empty_text": ".", "extract": "CHROM POS REF ALT DP AF SB DP4 EFF[*].IMPACT EFF[*].FUNCLASS EFF[*].EFFECT EFF[*].GENE EFF[*].CODON", "input": {"__class__": "ConnectedValue"}, "one_effect_per_line": "true", "separator": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'a7f0d5c3-4299-4a4e-9b59-60fdbb6166ad', 'workflow_outputs': [{'label': 'SnpSift tabular output', 'output_name': 'output', 'uuid': 'f722d19c-4128-460e-bbbc-1b6578a380cc'}]}, '11': {'annotation': '', 'content_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'errors': None, 'id': 11, 'input_connections': {'input1': {'id': 9, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'Convert VCF to VCF_BGZIP', 'outputs': [{'name': 'output1', 'type': 'vcf_bgzip'}], 'position': {'left': 2204.04296875, 'top': 484.921875}, 'post_job_actions': {'RenameDatasetActionoutput1': {'action_arguments': {'newname': 'SnpEff vcf.gz'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output1'}}, 'tool_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'tool_state': '{"input1": {"__class__": "ConnectedValue"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'db44ef5f-4338-4559-9bbc-0476f557ded5', 'workflow_outputs': [{'label': 'SnpEff vcf.gz', 'output_name': 'output1', 'uuid': '462a7e90-6591-42e9-ad44-e8519999f6bd'}]}}, 'tags': '', 'uuid': '61555898-ef63-4610-9e1c-aaed779b8e1c'}, 'tool_id': '62ae8ba707d543e1', 'type': 'subworkflow', 'uuid': '32e5a175-4eff-48ec-a908-9347521565ec', 'workflow_outputs': [{'label': None, 'output_name': 'Realigned Alignments', 'uuid': '6cb4c9ac-4747-4fd0-ad0a-bcbe71f03451'}, {'label': None, 'output_name': 'SnpEFF HTML stats', 'uuid': '00def8e1-eb34-4cc6-9543-f89ce311fc1a'}, {'label': None, 'output_name': 'SnpSift tabular output', 'uuid': '12adadcc-3202-4016-9da7-2f76f206094c'}, {'label': None, 'output_name': 'SnpEff vcf.gz', 'uuid': '70f5393a-3a36-478a-bb3a-d9b58ce3d4c3'}, {'label': None, 'output_name': 'MultiQC Report SE', 'uuid': 'd752c65a-2485-49c1-9b8d-566a12261b24'}]}, '5': {'annotation': '', 'content_id': '__MERGE_COLLECTION__', 'errors': None, 'id': 5, 'input_connections': {'inputs_0|input': {'id': 3, 'output_name': 'SnpSift tabular output'}, 'inputs_1|input': {'id': 4, 'output_name': 'SnpSift tabular output'}}, 'inputs': [], 'label': 'Merge SnpSift collection', 'name': 'Merge Collections', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1059.0234375, 'top': 200}, 'post_job_actions': {'HideDatasetActionoutput': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output'}, 'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Merged SnpSift tables'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': '__MERGE_COLLECTION__', 'tool_state': '{"advanced": {"conflict": {"duplicate_options": "keep_first", "__current_case__": 3}}, "inputs": [{"__index__": 0, "input": {"__class__": "ConnectedValue"}}, {"__index__": 1, "input": {"__class__": "ConnectedValue"}}], "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'e7837d93-baba-4aeb-a2e2-83edd6c74817', 'workflow_outputs': []}, '6': {'annotation': '', 'content_id': '__MERGE_COLLECTION__', 'errors': None, 'id': 6, 'input_connections': {'inputs_0|input': {'id': 3, 'output_name': 'SnpEff vcf.gz'}, 'inputs_1|input': {'id': 4, 'output_name': 'SnpEff vcf.gz'}}, 'inputs': [], 'label': 'Merge SnpEff vcf.gz collection', 'name': 'Merge Collections', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1059.0234375, 'top': 409.00390625}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Merged SnpEff vcf'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': '__MERGE_COLLECTION__', 'tool_state': '{"advanced": {"conflict": {"duplicate_options": "keep_first", "__current_case__": 3}}, "inputs": [{"__index__": 0, "input": {"__class__": "ConnectedValue"}}, {"__index__": 1, "input": {"__class__": "ConnectedValue"}}], "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '63e3d3a3-048c-43fb-bb6a-5bb27513e82a', 'workflow_outputs': [{'label': 'Merged SnpEff vcf', 'output_name': 'output', 'uuid': '53449c00-3b7a-449b-85dc-26e44a5f2fe7'}]}, '7': {'annotation': '', 'content_id': '__MERGE_COLLECTION__', 'errors': None, 'id': 7, 'input_connections': {'inputs_0|input': {'id': 3, 'output_name': 'Realigned Aligments'}, 'inputs_1|input': {'id': 4, 'output_name': 'Realigned Alignments'}}, 'inputs': [], 'label': 'Merge realigned BAM files', 'name': 'Merge Collections', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1059.0234375, 'top': 620}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Merged realigned BAM'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': '__MERGE_COLLECTION__', 'tool_state': '{"advanced": {"conflict": {"duplicate_options": "keep_first", "__current_case__": 3}}, "inputs": [{"__index__": 0, "input": {"__class__": "ConnectedValue"}}, {"__index__": 1, "input": {"__class__": "ConnectedValue"}}], "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '42db4955-972a-4f69-b163-173772ad4046', 'workflow_outputs': [{'label': 'Merged realigned BAM', 'output_name': 'output', 'uuid': '6e119c39-3148-4ee5-8dd9-bbe1ede44799'}]}, '8': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/4.2', 'errors': None, 'id': 8, 'input_connections': {'input_list': {'id': 5, 'output_name': 'output'}}, 'inputs': [], 'label': 'SnpSift summary table', 'name': 'Collapse Collection', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1345.01953125, 'top': 200}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'SnpSift summary table'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/4.2', 'tool_shed_repository': {'changeset_revision': '830961c48e42', 'name': 'collapse_collections', 'owner': 'nml', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"filename": {"add_name": "true", "__current_case__": 0, "place_name": "same_multiple"}, "input_list": {"__class__": "ConnectedValue"}, "one_header": "true", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '672c06f1-e49f-45ef-afff-ce43bfc59f65', 'workflow_outputs': [{'label': 'SnpSift summary table', 'output_name': 'output', 'uuid': 'f40ac366-7ed6-4719-8cdb-fcfc2abfd4f3'}]}}, 'tags': [], 'uuid': '1014c058-5bb1-409c-b107-cbfd4f509ffe', 'version': 1}


@click.command("Run Download and SE+PE Illumina Covid Variation Workflow workflow")
@click.option("--nc_45512_genbank_file", type=click.Path(exists=True))
@click.option("--accessions_file", type=click.Path(exists=True))
@click.option('-a', '--api_key', help="API key to use for running workflow")
@click.option('-g', '--galaxy_url', default="https://usegalaxy.org", help="Galaxy URL to use for running workflow", show_default=True)
@click.option('-h', '--history_id', help="History ID that will contain workflow results")
@click.option('-n', '--new_history_name', help="Create a new history with this name. Will not be used if history ID is provided.")
@click.option('--publish/--private', default=False, help="Publish history?")
@click.option('--monitor_invocation/--no_monitor_invocation', default=False, help="Print workflow invocation status updates?")
@click.option('--quiet', default=False, help='Decrease logging output')
def run_download_and_se_pe_illumina_covid_variation_workflow(nc_45512_genbank_file, accessions_file, api_key, galaxy_url, history_id, new_history_name, publish, monitor_invocation, quiet):
    """
    Run Download and SE+PE Illumina Covid Variation Workflow workflow
    """
    if quiet:
        log.setLevel(logging.ERROR)
    gi = bioblend.galaxy.GalaxyInstance(galaxy_url, api_key)
    workflow_id = '1014c058-5bb1-409c-b107-cbfd4f509ffe'
    workflow_found = True
    try:
        gi.workflows.show_workflow(workflow_id)
    except Exception as e:
        if "No such workflow" in str(e):
            workflow_found = False
        else:
            raise e
    if not workflow_found:
        if FULL_WORKFLOW:
            gi.workflows.import_workflow_dict(FULL_WORKFLOW)
            log.info("Imported workflow")
        else:
            raise Exception("Workflow with id '%s' not uploaded or not accessible" % workflow_id)
    if history_id is None:
        if new_history_name is None:
            new_history_name = 'History for Download and SE+PE Illumina Covid Variation Workflow execution'
        history = gi.histories.create_history(name=new_history_name)
    else:
        history = gi.histories.show_history(history_id)
    history_id = history['id']
    if publish:
        history = gi.histories.update_history(history_id, published=True, importable=True)
        history_url = urljoin(galaxy_url, history['username_and_slug'])
    else:
        history_url = urljoin(galaxy_url, "histories/view?id=%s" % history_id)
    # This will look a bit awkward,
    # those could become custom click types
    datasets_to_upload = [nc_45512_genbank_file, accessions_file]
    upload_paths = {}
    for dataset in datasets_to_upload:
        log.info("Uploading dataset '%s' to history %s", dataset, history_url)
        r = gi.tools.upload_file(path=dataset, history_id=history_id, to_posix_lines=False)
        upload_paths[dataset] = {'src': 'hda', 'id': r['outputs'][0]['id']}
    inputs = {
        'NC_45512 GenBank file': upload_paths.get(nc_45512_genbank_file, nc_45512_genbank_file),
        'Accessions file': upload_paths.get(accessions_file, accessions_file),
    }
    invocation = run_workflow(gi, workflow_id, history_id, inputs)
    assert invocation['state'] == 'new', "Expected invocation state to be 'new', but invocation is %s" % invocation
    log.info("Workflow '%s' started with invocation id '%s'. Results will appear in history %s", workflow_id, invocation['id'], history_url)
    if monitor_invocation:
        im = InvocationMonitor(gi)
        im.monitor_invocation(invocation['id'])


def run_workflow(gi, workflow_id, history_id, inputs):
    r = gi.workflows.invoke_workflow(
        workflow_id,
        inputs=inputs,
        history_id=history_id,
        inputs_by='name',
    )
    return r


if __name__ == '__main__':
    run_download_and_se_pe_illumina_covid_variation_workflow()